!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function c(t){return"function"==typeof t}function e(){var t=setTimeout;return function(){return t(r,1)}}function r(){for(var t=0;t<A;t+=2){(0,F[t])(F[t+1]),F[t]=void 0,F[t+1]=void 0}A=0}function u(t,e){var r=arguments,n=this,o=new this.constructor(f);void 0===o[H]&&b(o);var i,s=n._state;return s?(i=r[s-1],O(function(){return m(s,o,i,n._result)})):y(n,o,t,e),o}function a(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(f);return l(e,t),e}function f(){}function s(t){try{return t.then}catch(t){return L.error=t,L}}function h(t,e,r){var n,o,i,s;e.constructor===t.constructor&&r===u&&e.constructor.resolve===a?(i=t,(s=e)._state===U?p(i,s._result):s._state===C?d(i,s._result):y(s,void 0,function(t){return l(i,t)},function(t){return d(i,t)})):r===L?d(t,L.error):void 0===r?p(t,e):c(r)?(n=e,o=r,O(function(e){var r=!1,t=function(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}(o,n,function(t){r||(r=!0,n!==t?l(e,t):p(e,t))},function(t){r||(r=!0,d(e,t))},e._label);!r&&t&&(r=!0,d(e,t))},t)):p(t,e)}function l(t,e){var r;t===e?d(t,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(r=e)||"object"==typeof r&&null!==r?h(t,e,s(e)):p(t,e)}function n(t){t._onerror&&t._onerror(t._result),v(t)}function p(t,e){t._state===M&&(t._result=e,t._state=U,0!==t._subscribers.length&&O(v,t))}function d(t,e){t._state===M&&(t._state=C,t._result=e,O(n,t))}function y(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+U]=r,o[i+C]=n,0===i&&t._state&&O(v,t)}function v(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)n=e[s],o=e[s+r],n?m(r,n,o,i):o(i);t._subscribers.length=0}}function t(){this.error=null}function m(t,e,r,n){var o=c(r),i=void 0,s=void 0,u=void 0,a=void 0;if(o){if((i=function(t,e){try{return t(e)}catch(t){return X.error=t,X}}(r,n))===X?(a=!0,s=i.error,i=null):u=!0,e===i)return void d(e,new TypeError("A promises callback cannot return that same promise."))}else i=n,u=!0;e._state!==M||(o&&u?l(e,i):a?d(e,s):t===U?p(e,i):t===C&&d(e,i))}function b(t){t[H]=N++,t._state=void 0,t._result=void 0,t._subscribers=[]}function o(t,e){this._instanceConstructor=t,this.promise=new t(f),this.promise[H]||b(this.promise),T(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?p(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&p(this.promise,this._result))):d(this.promise,new Error("Array Methods must be provided an Array"))}function _(t){this[H]=N++,this._result=this._state=void 0,this._subscribers=[],f!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof _?function(e,t){try{t(function(t){l(e,t)},function(t){d(e,t)})}catch(t){d(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var i,w,g,E,T=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},A=0,P=void 0,x=void 0,O=function(t,e){F[A]=t,F[A+1]=e,2===(A+=2)&&(x?x(r):q())},R="undefined"!=typeof window?window:void 0,j=R||{},S=j.MutationObserver||j.WebKitMutationObserver,D="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),B="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,F=new Array(1e3),q=void 0;q=D?function(){return process.nextTick(r)}:S?(w=0,g=new S(r),E=document.createTextNode(""),g.observe(E,{characterData:!0}),function(){E.data=w=++w%2}):B?((i=new MessageChannel).port1.onmessage=r,function(){return i.port2.postMessage(0)}):void 0===R&&"function"==typeof require?function(){try{var t=require("vertx");return void 0!==(P=t.runOnLoop||t.runOnContext)?function(){P(r)}:e()}catch(t){return e()}}():e();var H=Math.random().toString(36).substring(16),M=void 0,U=1,C=2,L=new t,X=new t,N=0;return o.prototype._enumerate=function(){for(var t=this.length,e=this._input,r=0;this._state===M&&r<t;r++)this._eachEntry(e[r],r)},o.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===a){var o=s(e);if(o===u&&e._state!==M)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===_){var i=new r(f);h(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},o.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===M&&(this._remaining--,t===C?d(n,r):this._result[e]=r),0===this._remaining&&p(n,this._result)},o.prototype._willSettleAt=function(t,e){var r=this;y(t,void 0,function(t){return r._settledAt(U,e,t)},function(t){return r._settledAt(C,e,t)})},_.all=function(t){return new o(this,t).promise},_.race=function(o){var i=this;return new i(T(o)?function(t,e){for(var r=o.length,n=0;n<r;n++)i.resolve(o[n]).then(t,e)}:function(t,e){return e(new TypeError("You must pass an array to race."))})},_.resolve=a,_.reject=function(t){var e=new this(f);return d(e,t),e},_._setScheduler=function(t){x=t},_._setAsap=function(t){O=t},_._asap=O,_.prototype={constructor:_,then:u,catch:function(t){return this.then(null,t)}},_.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=_},_.Promise=_}),ES6Promise.polyfill(),function(n){"use strict";if(!n.fetch){c.prototype.append=function(t,e){t=s(t),e=u(e);var r=this.map[t];r||(r=[],this.map[t]=r),r.push(e)},c.prototype.delete=function(t){delete this.map[s(t)]},c.prototype.get=function(t){var e=this.map[s(t)];return e?e[0]:null},c.prototype.getAll=function(t){return this.map[s(t)]||[]},c.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},c.prototype.set=function(t,e){this.map[s(t)]=[u(e)]},c.prototype.forEach=function(e){var r=this;Object.getOwnPropertyNames(this.map).forEach(function(t){e(t,r.map[t])})};var o={blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in n},i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],a=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);e.call(l.prototype),e.call(p.prototype),n.Headers=c,n.Request=l,n.Response=p,n.fetch=function(t,e){var r;return r=l.prototype.isPrototypeOf(t)&&!e?t:new l(t,e),new fetch.Promise(function(i,s){var u=function(){return a&&!/^(get|post|head|put|delete|options)$/i.test(this.method)?(this.usingActiveXhr=!0,new ActiveXObject("Microsoft.XMLHTTP")):new XMLHttpRequest}();function t(){if(4===u.readyState){var t=1223===u.status?204:u.status;if(t<100||599<t)s(new TypeError("Network request failed"));else{var e,o,r={status:t,statusText:u.statusText,headers:(e=u,o=new c,e.getAllResponseHeaders().trim().split("\n").forEach(function(t){var e=t.trim().split(":"),r=e.shift().trim(),n=e.join(":").trim();o.append(r,n)}),o),url:"responseURL"in u?u.responseURL:/^X-Request-URL:/m.test(u.getAllResponseHeaders())?u.getResponseHeader("X-Request-URL"):void 0},n="response"in u?u.response:u.responseText;i(new p(n,r))}}}"cors"===r.credentials&&(u.withCredentials=!0),u.onreadystatechange=t,n.usingActiveXhr||(u.onload=t,u.onerror=function(){s(new TypeError("Network request failed"))}),u.open(r.method,r.url,!0),"responseType"in u&&o.blob&&(u.responseType="blob"),r.headers.forEach(function(e,t){t.forEach(function(t){u.setRequestHeader(e,t)})}),u.send()})},fetch.Promise=n.Promise,n.fetch.polyfill=!0}function s(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=t.toString()),t}function c(e){this.map={};var r=this;e instanceof c?e.forEach(function(e,t){t.forEach(function(t){r.append(e,t)})}):e&&Object.getOwnPropertyNames(e).forEach(function(t){r.append(t,e[t])})}function f(t){if(t.bodyUsed)return fetch.Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function h(r){return new fetch.Promise(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function t(t){var e=new FileReader;return e.readAsArrayBuffer(t),h(e)}function e(){return this.bodyUsed=!1,this._initBody=function(t){if("string"==typeof(this._bodyInit=t))this._bodyText=t;else if(o.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(o.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error("unsupported BodyInit type");this._bodyText=""}},o.blob?(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return fetch.Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return fetch.Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(t)},this.text=function(){var t,e,r=f(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,(e=new FileReader).readAsText(t),h(e);if(this._bodyFormData)throw new Error("could not read FormData body as text");return fetch.Promise.resolve(this._bodyText)}):this.text=function(){var t=f(this);return t||fetch.Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(r)}),this.json=function(){return this.text().then(function(t){return JSON.parse(t)})},this}function l(t,e){var r,n;if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new c(e.headers),this.method=(r=e.method||"GET",n=r.toUpperCase(),-1<i.indexOf(n)?n:r),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function r(t){var o=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),r=e.shift().replace(/\+/g," "),n=e.join("=").replace(/\+/g," ");o.append(decodeURIComponent(r),decodeURIComponent(n))}}),o}function p(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=200<=this.status&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof c?e.headers:new c(e.headers),this.url=e.url||""}}(window);